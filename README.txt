# openair-cn-cups
Control User Plane Separation of SPGW-C and SPGW-U
├── http://www.openairinterface.org/?page_id=698 

It is distributed under OAI Public License V1.0. 
The license information is distributed under LICENSE file in the same directory.

The OpenAirInterface CN CUPS software is composed of the following parts: 

openair-cn-cups
├── build :       Build directory, contains targets and object files generated by compilation of network functions. 
    ├── log :     Directory containing build log files.
    ├── scripts : Directory containing scripts for building network functions
    ├── spgw_c :  Directory containing CMakefile.txt and object files generated by compilation of SPGW-C network function. 
    ├── spgw_u :  Directory containing CMakefile.txt and object files generated by compilation of SPGW-U network function. 
├── etc :         Directory containing the configuration files to be deployed for each network function.
└── src :         Source files of network functions.
    ├── common :    Common header files
    │   ├── msg :   ITTI messages definitions.
    │   └── utils : Common utilities.
    ├── gtpv1u :    Generic GTPV1-U stack implementation
    ├── gtpv2c :    Generic GTPV2-C stack implementation
    ├── itti :      Inter task interface 
    ├── oai_spgwc : SPGW-C main directory, contains the "main" CMakeLists.txt file.
    ├── oai_spgwu : SPGW-U main directory, contains the "main" CMakeLists.txt file.
    ├── pfcp :      Generic PFCP stack implementation.
    ├── pgwc :      PGW-C network fonctions procedures and contexts.
    ├── sgwc :      SGW-C network fonctions procedures and contexts.
    ├── spgwu :     SPGW-U network fonctions procedures and contexts.
    │   └── simpleswitch : Very Basic Switch implementation.
    └── udp :       UDP server implementation.

RELEASE NOTES:

v1.0.0 -> First release, Able to serve a MME with basic attach, detach, release, paging procedures, default bearer only.

# OAI-SMF

## Download source code from Gitlab
git clone https://gitlab.eurecom.fr/oai/oai-cn5g-smf/
cd oai-cn5g-smf/
git checkout develop

## install dependencies
cd /oai-cn5g-smf/build/scripts
./build_spgwc -I -f
## build SMF
./build_spgwc -c -V -b Debug -j

## Create configuration file for SMF
cd /oai-cn5g-smf/src/test/inputs
./spgwc_conf.sh

## launch SMF
sudo spgwc -c /usr/local/etc/oai/spgw_c.conf -o 

## Build UPF (SPGWU)
git clone https://github.com/OPENAIRINTERFACE/openair-cn-cups/
cd /openair-cn-cups/build/scripts
./build_spgwu -I -f
./build_spgwu -c -V -b Debug -j

## Launch UPF
cd /oai-cn5g-smf/src/test/inputs
./spgwu_conf.sh
sudo spgwu -c /usr/local/etc/oai/spgw_u.conf  -o

## Build and launch UDM
cd /oai-cn5g-smf/src/test/udm
mkdir build
cd build
cmake ..
make
./udm-server

###test with curl
cd /oai-cn5g-smf/src/test/inputs
curl -X POST http://127.0.0.1:8080/nsmf-pdusession/v1/sm-contexts --data @apitest.json
